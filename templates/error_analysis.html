{% extends "logged_in.html" %}

{% block title %}Analyze{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="/static/css/chartist.js-0.11.0/chartist.min.css">
    <link rel="stylesheet" href="/static/css/font-awesome-4.7.0/font-awesome.css">
{% endblock %}

{% block body2 %}
    <h1>
        Analyze logs
        <span class="fa fa-spin fa-refresh ml-4 d-none" id="throbber"></span>
    </h1>
    <form method="POST">
        <div class="form-group">
            <label for="file">File</label>
            {% for log in logs %}
                <div class="form-check">
                    <label class="form-check-label">
                        <input class="form-check-input" type="radio" name="file" value="{{ log.id }}">
                        {{ log.filename }}
                    </label>
                </div>
            {% endfor %}
        </div>

        <div class="form-group">
            <label for="from">Start time</label>
            <input id="from"
                   name="from"
                   type="text"
                   class="form-control"
                   placeholder="Start time">
            <div id="from-feedback" class="invalid-feedback" style="display: none;">
                The value you’ve entered is not a valid date/time (use ISO 8601 formatting: 2013-02-08 09:30:26.123)
            </div>
        </div>

        <div class="form-group">
            <label for="to">End time</label>
            <input id="to"
                   name="to"
                   type="text"
                   class="form-control"
                   placeholder="End time">
            <div id="to-feedback" class="invalid-feedback" style="display: none;">
                The value you’ve entered is not a valid date/time (use ISO 8601 formatting: 2013-02-08 09:30:26.123)
            </div>
        </div>
    </form>

    <div class="d-none" id="charts">
        <h1>Charts</h1>
        <button type="button" class="btn btn-secondary" autocomplete="off" id="btn-details">Show details</button>
        <table>
            <thead>
                <tr>
                    <th class="pr-3">Error Name</th>
                    <th class="pr-3">Occurrences</th>
                    <th class="d-none" id="thead-details">Details</th>
                </tr>
            </thead>
            <tbody id="tbody">
            </tbody>
        </table>
        <div id="chart-timeline" class="ct-chart"></div>
        <div id="chart-proportion-errors" class="ct-chart"></div>
        <div id="chart-proportion-auth-principals" class="ct-chart"></div>
    </div>
{% endblock %}

{% block scripts %}
    <script defer src="/static/js/chartist.js-0.11.0/chartist.min.js"></script>
    <script defer src="/static/js/moment.js-2.18.1/moment.min.js"></script>
    <script defer src="/static/js/bootstrap-4.0.0-beta2/bootstrap.js"></script>
    <script defer src="/static/js/ui.js"></script>
    <script defer src="/static/js/error_analysis.js"></script>
{% endblock %}
